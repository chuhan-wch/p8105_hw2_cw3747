---
title: "p8105-hw2-cw3747"
author: "chuhan wang_cw3747"
date: "2025-09-24"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Problem 1.1
```{r}
library(tidyverse)
pols = read_csv("./538_datasets/pols-month.csv")
```

```{r}
pols = pols |>
  separate(mon, c("year", "month", "day"), sep = "-") |>
  mutate(month = month.abb[as.numeric(month)]) |>
  mutate(president = case_when(
    prez_dem == 1 ~ "dem",
    prez_gop == 1 ~ "gop"
  )) |>
  select(-prez_gop, -prez_dem, -day)
```

## Problem 1.2
```{r}
snp = read_csv("./538_datasets/snp.csv") |>
  separate(date, c("month", "date", "year"), sep = "/") |>
  mutate(
    month = factor(month.abb[as.integer(month)], levels = month.abb, ordered = TRUE),
    year = as.numeric(year),
    year = ifelse(year < 100, ifelse(year >= 50, 1900 + year, 2000 + year), year)
    ) |>
  select(year, month, close) |>
  arrange(year, month)
```

## Problem 1.3
```{r}
unemp = read_csv("./538_datasets/unemployment.csv") |>
  rename(year = Year) |>
  pivot_longer(
    cols = Jan:Dec,
    names_to = "month",
    values_to = "unemployment"
  ) |>
  mutate(
    month = factor(month, levels = month.abb, ordered = TRUE),
    year = as.numeric(year)
    ) |>
  arrange(year, month)
```

## Problem 1.4
```{r}
pols = pols |>
  mutate(
    year = as.integer(year),
    month = as.character(month))

snp = snp |>
  mutate(
    year = as.integer(year),
    month = as.character(month))

unemp = unemp |>
  mutate(
    year = as.integer(year),
    month = as.character(month))
```

```{r}
pols_merged = pols |>
  left_join(snp, by = c("year", "month")) |>
  left_join(unemp, by = c("year", "month"))
```

## Description
The pols-moth dataset presents the political composition of the U.S. government, including counts of Democratic and Republican governors, senators, and representatives, along with the president’s party from January 1947 to June 2015.The snp dataset provides monthly closing values of the Standard & Poor’s stock index, reflecting stock market performance over time from January 1950 to June 2015. And the unemployment dataset shows monthly unemployment rates from 1948 through 2015. The resulting dataset spans roughly 1950 to mid-2015. It combines political composition, stock market performance, and unemployment trends into one frame, with key variables including year, month, president, governors, senators, representatives, close (S&P index), and unemployment rate. This integrated dataset allows examination of relationships between political context, economic indicators, and labor market conditions.

## Problem 2
### Mr. Trash Wheel
```{r}
library(tidyverse)
library(readxl)
library(janitor)
library(lubridate)

Mr_data = read_excel("./202409 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel", skip = 1) |>
  janitor::clean_names() |>
  select(where(~ !all(is.na(.x)))) |>
  filter(!is.na(dumpster)) |>
  mutate(sports_balls = as.integer(round(sports_balls)))
```

### Combination
```{r}
Pf_data = read_excel("./202409 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", skip = 1) |>
  janitor::clean_names() |>
  select(where(~ !all(is.na(.x)))) |>
  filter(!is.na(dumpster))
  
Gwy_data = read_excel("./202409 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel", skip = 1) |>
  janitor::clean_names() |>
  select(where(~ !all(is.na(.x)))) |>
  filter(!is.na(dumpster))
```

```{r}
Mr_data = Mr_data |>
  mutate(date = lubridate::as_date(date),
         month = lubridate::month(date, abbr = TRUE, label = TRUE),
         year = lubridate::year(date),
         source = "Mr"
         )
Pf_data = Pf_data |>
  mutate(date = lubridate::as_date(date),
         month = lubridate::month(date, abbr = TRUE, label = TRUE),
         year = lubridate::year(date),
         source = "Pf"
         )
Gwy_data = Gwy_data |>
  mutate(date = lubridate::as_date(date),
         month = lubridate::month(date, abbr = TRUE, label = TRUE),
         year = lubridate::year(date),
         source = "Gwy"
         )

twc_all = dplyr::bind_rows(Mr_data, Pf_data, Gwy_data)
```

